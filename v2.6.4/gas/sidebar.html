<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>* {font-size: 12px !important;}html, body {width: 100%;height: 100%;}#container {width: calc(100% - 16px);height: calc(100% - 16px);}#settings-table {width: 100%;border-collapse: collapse;}#settings-table th, #settings-table td {padding: 10px;}#settings-table th {width: 25%;text-align: left;}.setting-items {width: 100%;}#loader {display: none;}.loader {width: 100%;height: 22px;border-radius: 20px;color: #6C88C3;border: 2px solid;position: relative;margin: 0 auto 8px;}.loader::before {content: "";position: absolute;margin: 2px;inset: 0 100% 0 0;border-radius: inherit;background: currentColor;animation: l6 10s infinite;}.loader-text {font-size: 11px !important;color: #efefef;position: absolute;top: 0;left: 0;right: 0;bottom: 0;margin: auto;display: block;width: 100%;height: 100%;line-height: 22px;text-align: center;}@keyframes l6 {100% {inset:0}}.footer_wave {position: fixed;left: 0;bottom: 0;width: 100%;}.parallax > use {animation: move-forever 12s linear infinite;}.parallax > use:nth-child(1) {animation-delay: -2s;}.parallax > use:nth-child(2) {animation-delay: -2s;animation-duration: 5s;}.parallax > use:nth-child(3) {animation-delay: -4s;animation-duration: 3s;}@keyframes move-forever {0% {transform: translate(-90px, 0%);}100% {transform: translate(85px, 0%);}}.editorial {display: block;width: 100%;height: 3em;max-height: 100vh;margin: 0;bottom: 0px;opacity:0.7;}@media (max-width: 50em) {.editorial {height: 10vw;}}#start-btn {width: 100%;color: #ffffff;text-align: center;background-color: #6C88C3;border-radius: 10px;vertical-align: middle;cursor: pointer;transition: all 0.3s ease;transform: scale(1);box-shadow: 0px 5px 15px 0px rgba(0, 0, 0, 0.35);}.start-btn-calling {background-color: #616161 !important;}#start-btn:hover {transform: scale(0.98);background-color: #4870c7;}#start-btn:active {transform: scale(0.95)}#start-btn-box {width: 100%;padding-top: calc(100vh - 50px);position: relative;}.start-btn-box-calling {padding-top: calc(100vh - 88px) !important;}#start-btn-box-text {position: absolute;top: 0;left: 0;right: 0;bottom: 0;margin: auto;line-height: 30px;text-align: center;display: block;height: 30px;font-size: 20px !important;}</style>
  </head>
  <body>
    <div id="container"><div id="loader" class="loader"><span class="loader-text">Calling...</span></div><div id="start-btn"><div id="start-btn-box"><div id="start-btn-box-text">発信を開始する</div></div></div></div>
    <div class=footer_wave><svg class="editorial" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" /></defs><g class="parallax"><use xlink:href="#gentle-wave" x="50" y="0" fill="#4579e2"/><use xlink:href="#gentle-wave" x="50" y="3" fill="#3461c1"/><use xlink:href="#gentle-wave" x="50" y="6" fill="#2d55aa"/></g></svg><div>
    <script>const loader = document.getElementById('loader');const startBtn = document.getElementById('start-btn');const startBtnBox = document.getElementById('start-btn-box');const startBtnBoxText = document.getElementById('start-btn-box-text');const startBtnCallingCls = 'start-btn-calling';const startBtnBoxCallingCls = 'start-btn-box-calling';const setCalling = () => { loader.style.display = 'block'; startBtn.classList.add(startBtnCallingCls); startBtnBox.classList.add(startBtnBoxCallingCls); startBtnBoxText.innerHTML = '発信中です...'; };const reset = () => { loader.style.display = 'none'; startBtn.classList.remove(startBtnCallingCls); startBtnBox.classList.remove(startBtnBoxCallingCls); startBtnBoxText.innerHTML = '発信を開始する'; };const onRunEdgesXoutSuccess = ok => { reset(); if (!ok) { alert('電話番号が不正です。'); return; }; };const onFailure = err => { reset(); alert('Failed: ' + err.message); };const onGetSelectedCellValueSuccess = (number) => { google.script.run.withSuccessHandler(onRunEdgesXoutSuccess).withFailureHandler(onFailure).__veins_runEdgesXout(number); };startBtn.onclick = () => { setCalling(); google.script.run.withSuccessHandler(onGetSelectedCellValueSuccess).withFailureHandler(onFailure).__veins_getSelectedCellValue(); };</script>
  </body>
</html>